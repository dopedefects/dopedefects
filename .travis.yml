# what language the build will be configured for
language: python

# note that all of the versions listed will be tried
python:
  - "3.6"

# what branches should be evaluated
branches:
  only:
    - master
    - structure_extract

# list of commands to run to setup the environment
install:
  - pip install pytest
  - pip install pytest-cov
  - pip install --upgrade setuptools
  - pip install coverage
  - pip install coveralls
  - pip install flake8
  - pip install -r requirements.txt

# a list of commands to run before the main script
before_script:
  - export PYTHONPATH=$PYTHONPATH:$(pwd)
#  - "flake8 dopedefects"

script:
  #- flake8 `find . -name \*.py | grep -v setup.py | grep -v version.py | grep -v __init__.py| grep -v /doc/ | grep -v /data/`
  - py.test -s --pyargs dopedefects --cov-report term-missing --cov=dopedefects --cov-config .coveragerc

# generate a coverage report to send to back to user
after_success:
  - coveralls
